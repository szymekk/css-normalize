# CSS normalize

CSS normalize is a tool for normalizing CSS files.
It was developed to facilitate comparing CSS files using text comparison tools such as diff.
It takes a CSS stylesheet as input and outputs a semantically equivalent normalized stylesheet.
The aforementioned equivalence means that the output file might e.g. have a different order of style rules but no rules may be added or removed.
The output file is normalized, or canonical, in the sense that running the tool on an already normalized stylesheet should produce output identical to the input.
In other words the process of normalization is idempotent.

Transformations applied include:

- sorting declarations within a style rule by property name,
- sorting selectors in a group of comma separated selectors,
- adding leading zeros to floating point numeric values (e.g. changing `.5em` to `0.5em`),
- stripping leading plus signs from numeric values (e.g. changing `+2` to `2`),
- inserting omitted semicolons after trailing CSS properties,
- using double quotes on all strings (e.g. changing `'a string'` to `"a string"`),
- applying uniform formatting, including collapsing excessive whitespace, putting each property in a separate line, aligning indentation.

## Building

To build CSS normalize use `stack` as follows:

```console
$ stack build
```

## Usage

The binary name for CSS normalize is `cssn`.
You can specify the input file by passing its' name as the first positional parameter.

```console
$ cssn raw.css > normalized.css
```

Alternatively the stylesheet may be read from stdin.
Therefore the same effect as in the above example can be achieved using input redirection.

```console
$ cssn < raw.css > normalized.css
```

Perhaps a more interesting application is reading a stylesheet generated by another tool in a pipeline.
An example use case would be normalizing a stylesheet generated by a SASS to CSS translator.

```console
$ sass input.scss | cssn > normalized_output.css
```

To compare two css files first normalize both with cssn.

```console
$ cssn a.css > a.norm.css
$ cssn b.css > b.norm.css
```

Then compare the normalized files using a standard text comparison tool such as diff.

```console
$ diff a.norm.css b.norm.css
```

## Example output

Here is an example showing the results of running CSS normalize on a messy CSS file.
It demonstrates several of the implemented transformations.

```console
$ cat input.css
     @media only
 screen{  :lang(pl)::before,:lang(fr)::before {color
:green ;display: block; font-size : large;content
 :"string 1"}}.b::before   ,
.a::before{display      :block;color: blue ;
     font-size:
large;

         margin:-.1em
   -0.1em +2px 2px
   ;
        content:   'string 2'   ;   }
$ cssn input.css
@media only screen {
    :lang(fr)::before, :lang(pl)::before {
        color: green;
        content: "string 1";
        display: block;
        font-size: large;
    }
}
.a::before, .b::before {
    color: blue;
    content: "string 2";
    display: block;
    font-size: large;
    margin: -0.1em -0.1em 2px 2px;
}

```
